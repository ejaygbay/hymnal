<template>
  <div class="page" data-name="songs">
    <!-- Top Navbar -->
    <div class="navbar navbar-large">
      <div class="navbar-bg"></div>
      <div class="navbar-inner">
        <div class="left">
          <a href="#" class="link icon-only panel-open" data-panel="left">
            <i class="icon f7-icons if-not-md">menu</i>
            <i class="icon material-icons if-md">menu</i>
          </a>
        </div>
        <div class="title sliding">Songs</div>

        <div class="title-large">
          <div class="title-large-text">Songs</div>
        </div>
      </div>
    </div>

    <!-- Main page content -->
    <div class="page-content">
      <div class="list">
        <ol></ol>
      </div>
    </div>
  </div>
</template>

<script>
  export default {};
  import $$ from "dom7";

  let songs = {
    1: {
      title: "When we all get to heven",
      author: "John Doe",
      stanzas: {
        1: "Some texts 1",
        2: "SOme texts 2",
        3: "Some texts 3",
      },
      chorus: "Some texts Chorus",
      mp3: "../static/musicFiles/Faith.mp3",
      favorite: false,
    },
    2: {
      title: "To God be the Glory",
      author: "Melvin Palley",
      stanzas: {
        1: "Some texts 1",
        2: "SOme texts 2",
        3: "Some texts 3",
        4: "Some texts 4",
      },
      chorus: "Some texts Chorus",
      mp3: "../static/musicFiles/OurHelp.mp3",
      favorite: false,
    },
    3: {
      title: "Faith of our father",
      author: "Benson Kamada",
      stanzas: {
        1: "Some texts 1",
        2: "SOme texts 2",
      },
      chorus: "Some texts Chorus",
      mp3: "../static/musicFiles/Faith.mp3",
      favorite: false,
    },
  };

  $$(document).on("page:afterin", function (e) {
    let order_list = document.querySelector("ol");
    order_list.innerHTML = "";
    let keys = Object.keys(songs);

    keys.forEach((ele) => {
      // console.log("Keys:", songs[ele]);

      let title = songs[ele].title;
      let author = songs[ele].author;
      let audio_id = title.split(" ").join("-");
      let stanzas = Object.keys(songs[ele].stanzas).length;
      let music_file = songs[ele].mp3;
      let list_item = `
      <li>
        <div class="item-content">
          <a href="/single-song/">
            <div class="item-inner">
              <div class="item-title">
                <div class="item-header">By: ${author}</div>
                ${title}
                <div class="item-footer">${stanzas} Stanzas</div>
              </div>
            </div>
          </a>
          <div class="item-media">
            <i class="f7-icons">heart</i>
            <i class="f7-icons play" id="${audio_id}-play">play_circle</i>
            <i class="f7-icons stop" id="${audio_id}-stop" style="display:none">stop_circle</i>
            <audio
              src="${music_file}" id="${audio_id}"></audio>
          </div>
        </div>
      </li>
    `;

      order_list.insertAdjacentHTML("beforeend", list_item);
    });
    console.log("all song Page loaded fully:");

    $$(".play").on("click", function (e) {
      let play_btn_id = e.target.id;
      document
        .getElementById(play_btn_id)
        .setAttribute("style", "display: none");
      play_btn_id = play_btn_id.split("-").slice(0, -1).join("-");
      document
        .getElementById(`${play_btn_id}-stop`)
        .setAttribute("style", "display: block");
      document.getElementById(play_btn_id).play();
    });

    $$(".stop").on("click", function (e) {
      let stop_btn_id = e.target.id;
      document
        .getElementById(stop_btn_id)
        .setAttribute("style", "display: none");
      stop_btn_id = stop_btn_id.split("-").slice(0, -1).join("-");
      document
        .getElementById(`${stop_btn_id}-play`)
        .setAttribute("style", "display: block");
      document.getElementById(stop_btn_id).pause();
      document.getElementById(stop_btn_id).currentTime = 0;
    });
  });

  // var app = new Framework7();
  // // document.getElementById("play").innerHTML = "Hi";
  // app.on("pageInit", function (page) {
  //   // do something on page init
  //   console.log("Ollkjk", page);
  //   // app.dialog.alert("hipopo");

  //   $$(".play").on("click", function (e) {
  //     console.log("clicked");
  //   });

  //   function play() {
  //     alert("Ok");
  //   }
  // });
  // var $$ = Dom7;
  // $$("#play").on("click", function (e) {

  // app.dialog.alert("hi");
  // $$(this)
  //   .addClass("hello")
  //   .attr("title", "world")
  //   .insertAfter(".something-else");
  // });
</script>
